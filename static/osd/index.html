<!DOCTYPE html>
<html>
<head>
	<title>OSD</title>
	<meta name="viewport" content="wdith=device-width, initial-scale=1">
	<link id="root" rel="stylesheet" type="text/css" href="/osd/css/root.css">
	<style type="text/css">
		#psu {
			width: min-content;
			padding: var(--padding);
			border: var(--border-width) var(--border-style) var(--border-color);
			font-family: var(--font-family);
			line-height: var(--line-height);
			font-size: var(--font-size);
			font-weight: var(--font-weight);
			-webkit-text-stroke: var(--text-stroke-width) var(--text-stroke-color);
			background-color: var(--background-color);
			transition: opacity .5s;
			border-radius: var(--border-radius);
			box-shadow: var(--box-shadow);
		}

		.volts {
			color: var(--volt-color);
			text-align: right;
		}

		.amps {
			color: var(--amp-color);
			text-align: right;
		}

		.volts:after {
			content: "V";
		}

		.amps:after {
			content: "A";
		}

		.error {
			opacity: 0;
		}

		html,
		body {
			margin: 0;
			padding: 0
		}
	</style>
	<script>
		document.addEventListener("DOMContentLoaded", function (e) {
			const source = new EventSource("/es");
			const psu = document.getElementById("psu")
			const volts = psu.firstElementChild
			const amps = volts.nextElementSibling

			source.addEventListener("reload", (e) => {
				const r = document.getElementById("root")
				r.href = e.data
			})
			source.addEventListener("error", (e) => psu.classList.add("error"))
			source.addEventListener("open", (e) => psu.classList.remove("error"))
			source.addEventListener("psu", (e) => {
				const d = JSON.parse(e.data)
				volts.innerText = d.volts.toFixed(3)
				amps.innerText = d.amps.toFixed(3)
			});
		});
	</script>
</head>
<body>
	<div id="psu" class="error">
		<div class="volts" title="Volts"></div>
		<div class="amps" title="Amps"></div>
	</div>
</body>
</html>